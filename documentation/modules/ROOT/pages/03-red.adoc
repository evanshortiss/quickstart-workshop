= 3. Cluster Customizations (RED)
include::_attributes.adoc[]

[#user_access]
== User Access
Establish a shared project namespace that everyone on your team can use:

1. Use an admin account to create a new project namespace for the Red team to use:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc new-project red-team
----
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc project red-team
----

2. Provide existing user accounts with access to the `red-team` project namespace:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
for user in {1..10}; do oc adm policy add-role-to-user edit user$user ; done
----

[#custom_web_terminal]
== Configure Web Terminal defaults

Update the cluster default terminal image by modifying the *DevWorkspaceTemplate/web-terminal-tooling* resource:

1. Search *All Projects* for resources of type `DevWorkspaceTemplate`
+
image:red/1-search-all.png[Search All Projects]
+
image:red/2-search-resource.png[Search Resource type "DevWorkspaceTemplate"]

2. Select the resource named `web-terminal-tooling`
+
image:red/2-view-templates.png[View templates]

3. Click on `YAML` to modify the terminal settings
+
image:red/3-web-terminal-tooling.png[web terminal tooling]

4. Add a new annotation after line 5:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
web-terminal.redhat.com/unmanaged-state: "true"
----

4. Replace the `spec.components[].container.image` url with:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
quay.io/ryan_j/summitconnect:4.10.25
----

6. Click `Save` to set the new default terminal image for the cluster
+
image:red/4-web-terminal-tooling-yaml.png[web-terminal-tooling yaml config]

7. Close and restart your Web Terminal
8. In a new terminal, check the version of the `oc` command line tool:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc version
----
+
[.console-output]
[source,bash,subs="+macros,+attributes"]
----
Client Version: 4.10.25
Server Version: 4.10.26
Kubernetes Version: v1.23.5+012e945
----
+
[TIP]
====
If you don't see an updated client release available, use the following command to refresh the outdated web terminal tooling pod:

[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc delete pod -l 'controller.devfile.io/devworkspace_id'
----

There will be a brief pause while the Web Terminal tooling container is replaced
====


[TIP]
====
Non-admin users can also quickly override the default terminal image (without setting a new cluster default) using the `wtoctl` command:
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
wtoctl set image quay.io/ryan_j/summitconnect:latest
----
====



[#login_screen]
== Customize the Login Screen








[#header_logo]
== Customize the Header Logo

1. something
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
curl https://raw.githubusercontent.com/redhat-scholars/quickstart-workshop/master/apps/red/RedShell.png -o /tmp/red-shell.png
----

2. something 
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc create configmap console-custom-logo --from-file /tmp/red-shell.png -n openshift-config
----

3. Paste the following to generate a json patch file.  This file will be used to update the cluster console operator config:
+
[.console-input]
[source,yaml,subs="+macros,+attributes"]
----
cat <<EOF > /tmp/patch.yaml
spec:
  customization:
    customLogoFile:
      key: red-shell.png
      name: console-custom-logo
EOF
----

4. Send the configuration patch to the console cluster operator:
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
oc patch consoles.operator.openshift.io cluster --type merge --patch-file /tmp/patch.yaml`
----


[#notifications]
== Console Notifications

1. Click on the `Import` *(+)* link in the header, then paste the following YAML contnet:
+
[.console-input]
[source,yaml,subs="+macros,+attributes"]
----
apiVersion: console.openshift.io/v1
kind: ConsoleNotification
metadata:
  name: hackathon-banner
spec:
  text: Welcome Red Team to the Summit Connect 2022 Hackathon!
  location: BannerTop
  link:
    href: 'https://github.com/redhat-scholars/quickstart-workshop/tree/master/apps/red'
    text: (Red Team Repo)
  color: '#fafafa'
  backgroundColor: '#EE0000'
----

2. Click `Create` to make the new `ConsoleNotification` visible to all cluster users



[#quickstart_install]
== Quickstart Installation

1. Verify that you have an updated version of the `odo` command line tool: 
+
[.console-input]
[source,bash,subs="+macros,+attributes"]
----
odo version
----
+
[.console-output]
[source,bash,subs="+macros,+attributes"]
----
3.0.0beta3
----
+
TIP: If you find that you're still on odo version `2.5.0`, try repeating the link:#custom_web_terminal[previous section] to update your Web Terminal

2. Install a new quickstart and follow along with the demo script

[.console-input]
[source,bash,subs="+macros,+attributes"]
----
git clone https://github.com/sclorg/nodejs-ex
cd nodejs-ex
----

[.console-input]
[source,bash,subs="+macros,+attributes"]
----
odo init
----

Use interactive mode to set the following ENV variable: `PORT=3000`

[.console-input]
[source,bash,subs="+macros,+attributes"]
----
odo dev &
----

[.console-input]
[source,bash,subs="+macros,+attributes"]
----
sed -i views/index.html -e 's/your Node.js application on OpenShift/Red Hat Summit Connect 2022/'
----


